language: c
sudo: required

os:
  - linux

env:
  global:
    - DEVKITPRO=/opt/devkitpro
    - DEVKITPPC=${DEVKITPRO}/devkitPPC
    - GRRLIBVERS=4.3.2

cache:
  directories:
    - ${DEVKITPRO}
    - GRRLIB-${GRRLIBVERS}/GRRLIB

before_install:
  - wget https://github.com/devkitPro/pacman/releases/download/devkitpro-pacman-1.0.1/devkitpro-pacman.deb
  - wget https://github.com/GRRLIB/GRRLIB/archive/${GRRLIBVERS}.tar.gz -O GRRLIB.tar.gz

install:
  - sudo dpkg --install devkitpro-pacman.deb
  - sudo dkp-pacman --sync --sysupgrade --refresh --needed --noconfirm devkitPPC libogc libfat-ogc general-tools gamecube-tools
  - tar -xzvf GRRLIB.tar.gz
  - (cd GRRLIB-${GRRLIBVERS}/GRRLIB && sudo -E make all install)

script:
  - (cd GRRMOD && make && sudo -E make install)
  - (cd demo && make)
